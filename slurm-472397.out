NODELIST=a100-st2-p4de24xlarge-[0-3,38-39,50-51]
SLURM_GPUS_ON_NODE=8
MASTER_ADDR=a100-st2-p4de24xlarge-0
W0805 21:36:14.190959 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:14.190959 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:14.190959 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:14.190959 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.448565 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:25.448565 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.448565 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:25.448565 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.449632 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:25.449632 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.449632 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:25.449632 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.449788 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:25.449788 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.449788 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:25.449788 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.450259 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:25.450259 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.450259 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:25.450259 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.636114 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:25.636114 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.636114 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:25.636114 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.924303 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:25.924303 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:25.924303 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:25.924303 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:28.340884 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] 
W0805 21:36:28.340884 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
W0805 21:36:28.340884 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0805 21:36:28.340884 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py:766] *****************************************
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.29s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.46s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.26s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.55s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.55s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.03s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.10s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.64s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.46s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.94s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.91s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.96s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.96s/it]
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!



DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!


DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!




DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
[2025-08-05 14:38:08,067] INFO [src.utils:19] Loading backbone [qwen2_vl] from Qwen/Qwen2-VL-2B-Instruct
[2025-08-05 14:38:08,067] INFO [src.utils:19] Loading processor from: Qwen/Qwen2-VL-2B-Instruct
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!


DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!


DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

DropoutAddRMSNorm of flash_attn is not installed!!!
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.34s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.37s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.34s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.54s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.43s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.13s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.28s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.45s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.38s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.45s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.29s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.46s/it]

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.70s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.23s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.69s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.28s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.43s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.20s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.29s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.23s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.13s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.28s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.26s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.30s/it]


Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.43s/it]
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[2025-08-05 14:38:14,108] INFO [src.utils:19] Loading lora adapter from Qwen2VLForConditionalGeneration(
  (visual): Qwen2VisionTransformerPretrainedModel(
    (patch_embed): PatchEmbed(
      (proj): Conv3d(3, 1280, kernel_size=(2, 14, 14), stride=(2, 14, 14), bias=False)
    )
    (rotary_pos_emb): VisionRotaryEmbedding()
    (blocks): ModuleList(
      (0-31): 32 x Qwen2VLVisionBlock(
        (norm1): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
        (norm2): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
        (attn): VisionFlashAttention2(
          (qkv): Linear(in_features=1280, out_features=3840, bias=True)
          (proj): Linear(in_features=1280, out_features=1280, bias=True)
        )
        (mlp): VisionMlp(
          (fc1): Linear(in_features=1280, out_features=5120, bias=True)
          (act): QuickGELUActivation()
          (fc2): Linear(in_features=5120, out_features=1280, bias=True)
        )
      )
    )
    (merger): PatchMerger(
      (ln_q): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
      (mlp): Sequential(
        (0): Linear(in_features=5120, out_features=5120, bias=True)
        (1): GELU(approximate='none')
        (2): Linear(in_features=5120, out_features=1536, bias=True)
      )
    )
  )
  (model): Qwen2VLModel(
    (embed_tokens): Embedding(151936, 1536)
    (layers): ModuleList(
      (0-27): 28 x Qwen2VLDecoderLayer(
        (self_attn): Qwen2VLFlashAttention2(
          (q_proj): Linear(in_features=1536, out_features=1536, bias=True)
          (k_proj): Linear(in_features=1536, out_features=256, bias=True)
          (v_proj): Linear(in_features=1536, out_features=256, bias=True)
          (o_proj): Linear(in_features=1536, out_features=1536, bias=False)
          (rotary_emb): Qwen2VLRotaryEmbedding()
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=1536, out_features=8960, bias=False)
          (up_proj): Linear(in_features=1536, out_features=8960, bias=False)
          (down_proj): Linear(in_features=8960, out_features=1536, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((1536,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((1536,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((1536,), eps=1e-06)
    (rotary_emb): Qwen2VLRotaryEmbedding()
  )
  (lm_head): Linear(in_features=1536, out_features=151936, bias=False)
)
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.06s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.22s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.67s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.35s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.53s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.54s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.03s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.26s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.34s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.28s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.25s/it]





Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.33s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.62s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.24s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.51s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.14s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.39s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.17s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.17s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.14s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.02s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.95s/it]



Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.84s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.31s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.25s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.98s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.28s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.14s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.16s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.67s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.83s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.74s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]

You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.62s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.77s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.77s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.46s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.70s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.74s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.44s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.17s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.25s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.22s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.28s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.45s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.37s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.49s/it]


Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.12s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.98s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.58s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.08s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.88s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.77s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.71s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.46s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.25s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.45s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.65s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.70s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]

Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]
[2025-08-05 14:38:28,045] INFO [src.utils:10] rank56: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,045] INFO [src.utils:10] rank62: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,045] INFO [src.utils:10] rank63: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,046] INFO [src.utils:10] rank61: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,046] INFO [src.utils:10] rank59: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,046] INFO [src.utils:10] rank58: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,049] INFO [src.utils:10] rank60: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:28,050] INFO [src.utils:10] rank57: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:38,217] INFO [src.utils:19] Loaded mmeb/ImageNet_1K dataset with 100000 samples
[2025-08-05 14:38:38,217] INFO [src.utils:19] 		Dataset#0 (dataset_parser=mmeb): ImageNet_1K, num_rows=100000, prob=1.9230769230769231
[2025-08-05 14:38:39,072] INFO [src.utils:19] Loaded mmeb/N24News dataset with 48988 samples
[2025-08-05 14:38:39,072] INFO [src.utils:19] 		Dataset#1 (dataset_parser=mmeb): N24News, num_rows=48988, prob=1.9230769230769231
[2025-08-05 14:38:39,397] INFO [src.utils:19] Loaded mmeb/HatefulMemes dataset with 8500 samples
[2025-08-05 14:38:39,397] INFO [src.utils:19] 		Dataset#2 (dataset_parser=mmeb): HatefulMemes, num_rows=8500, prob=0.9615384615384616
[2025-08-05 14:38:39,595] INFO [src.utils:19] Loaded mmeb/VOC2007 dataset with 7844 samples
[2025-08-05 14:38:39,595] INFO [src.utils:19] 		Dataset#3 (dataset_parser=mmeb): VOC2007, num_rows=7844, prob=0.9615384615384616
[2025-08-05 14:38:39,966] INFO [src.utils:19] Loaded mmeb/SUN397 dataset with 19850 samples
[2025-08-05 14:38:39,966] INFO [src.utils:19] 		Dataset#4 (dataset_parser=mmeb): SUN397, num_rows=19850, prob=0.9615384615384616
[2025-08-05 14:38:40,286] INFO [src.utils:19] Loaded mmeb/OK-VQA dataset with 9009 samples
[2025-08-05 14:38:40,287] INFO [src.utils:19] 		Dataset#5 (dataset_parser=mmeb): OK-VQA, num_rows=9009, prob=0.9615384615384616
[2025-08-05 14:38:40,525] INFO [src.utils:19] Loaded mmeb/A-OKVQA dataset with 17056 samples
[2025-08-05 14:38:40,526] INFO [src.utils:19] 		Dataset#6 (dataset_parser=mmeb): A-OKVQA, num_rows=17056, prob=0.9615384615384616
[2025-08-05 14:38:41,113] INFO [src.utils:19] Loaded mmeb/DocVQA dataset with 39463 samples
[2025-08-05 14:38:41,113] INFO [src.utils:19] 		Dataset#7 (dataset_parser=mmeb): DocVQA, num_rows=39463, prob=1.9230769230769231
[2025-08-05 14:38:41,634] INFO [src.utils:19] Loaded mmeb/InfographicsVQA dataset with 23946 samples
[2025-08-05 14:38:41,634] INFO [src.utils:19] 		Dataset#8 (dataset_parser=mmeb): InfographicsVQA, num_rows=23946, prob=0.9615384615384616
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank21: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank18: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank16: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank20: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank22: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank23: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank19: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:41,857] INFO [src.utils:10] rank17: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,097] INFO [src.utils:10] rank2: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,097] INFO [src.utils:10] rank7: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,098] INFO [src.utils:10] rank1: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,098] INFO [src.utils:10] rank4: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,098] INFO [src.utils:10] rank5: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,098] INFO [src.utils:10] rank3: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,098] INFO [src.utils:10] rank6: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,098] INFO [src.utils:10] rank0: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,114] INFO [src.utils:19] Loaded mmeb/ChartQA dataset with 28000 samples
[2025-08-05 14:38:42,114] INFO [src.utils:19] 		Dataset#9 (dataset_parser=mmeb): ChartQA, num_rows=28000, prob=0.9615384615384616
[2025-08-05 14:38:42,915] INFO [src.utils:10] rank42: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,915] INFO [src.utils:10] rank41: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,915] INFO [src.utils:10] rank43: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,915] INFO [src.utils:10] rank45: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,916] INFO [src.utils:10] rank46: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,916] INFO [src.utils:10] rank47: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,916] INFO [src.utils:10] rank44: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:42,916] INFO [src.utils:10] rank40: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:43,069] INFO [src.utils:19] Loaded mmeb/Visual7W dataset with 69817 samples
[2025-08-05 14:38:43,069] INFO [src.utils:19] 		Dataset#10 (dataset_parser=mmeb): Visual7W, num_rows=69817, prob=1.9230769230769231
[2025-08-05 14:38:46,718] INFO [src.utils:19] Loaded mmeb/VisDial dataset with 123287 samples
[2025-08-05 14:38:46,718] INFO [src.utils:19] 		Dataset#11 (dataset_parser=mmeb): VisDial, num_rows=123287, prob=1.9230769230769231
[2025-08-05 14:38:47,358] INFO [src.utils:19] Loaded mmeb/CIRR dataset with 26116 samples
[2025-08-05 14:38:47,359] INFO [src.utils:19] 		Dataset#12 (dataset_parser=mmeb): CIRR, num_rows=26116, prob=0.9615384615384616
[2025-08-05 14:38:47,718] INFO [src.utils:10] rank8: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,718] INFO [src.utils:10] rank14: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,718] INFO [src.utils:10] rank11: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,718] INFO [src.utils:10] rank12: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,719] INFO [src.utils:10] rank9: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,719] INFO [src.utils:10] rank10: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,720] INFO [src.utils:10] rank13: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,720] INFO [src.utils:10] rank15: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,875] INFO [src.utils:10] rank33: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,875] INFO [src.utils:10] rank32: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,876] INFO [src.utils:10] rank39: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,876] INFO [src.utils:10] rank37: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,876] INFO [src.utils:10] rank36: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,876] INFO [src.utils:10] rank38: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,876] INFO [src.utils:10] rank35: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:47,876] INFO [src.utils:10] rank34: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:49,808] INFO [src.utils:19] Loaded mmeb/VisualNews_t2i dataset with 99903 samples
[2025-08-05 14:38:49,808] INFO [src.utils:19] 		Dataset#13 (dataset_parser=mmeb): VisualNews_t2i, num_rows=99903, prob=1.9230769230769231
[2025-08-05 14:38:51,676] INFO [src.utils:19] Loaded mmeb/VisualNews_i2t dataset with 100000 samples
[2025-08-05 14:38:51,676] INFO [src.utils:19] 		Dataset#14 (dataset_parser=mmeb): VisualNews_i2t, num_rows=100000, prob=1.9230769230769231
[2025-08-05 14:38:53,438] INFO [src.utils:19] Loaded mmeb/MSCOCO_t2i dataset with 100000 samples
[2025-08-05 14:38:53,439] INFO [src.utils:19] 		Dataset#15 (dataset_parser=mmeb): MSCOCO_t2i, num_rows=100000, prob=1.9230769230769231
[2025-08-05 14:38:53,662] INFO [src.utils:10] rank31: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,662] INFO [src.utils:10] rank24: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,663] INFO [src.utils:10] rank27: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,663] INFO [src.utils:10] rank30: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,663] INFO [src.utils:10] rank28: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,663] INFO [src.utils:10] rank29: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,663] INFO [src.utils:10] rank25: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:53,663] INFO [src.utils:10] rank26: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:55,193] INFO [src.utils:19] Loaded mmeb/MSCOCO_i2t dataset with 113287 samples
[2025-08-05 14:38:55,193] INFO [src.utils:19] 		Dataset#16 (dataset_parser=mmeb): MSCOCO_i2t, num_rows=113287, prob=1.9230769230769231
[2025-08-05 14:38:55,613] INFO [src.utils:19] Loaded mmeb/NIGHTS dataset with 15941 samples
[2025-08-05 14:38:55,614] INFO [src.utils:19] 		Dataset#17 (dataset_parser=mmeb): NIGHTS, num_rows=15941, prob=0.9615384615384616
[2025-08-05 14:38:56,085] INFO [src.utils:19] Loaded mmeb/WebQA dataset with 17166 samples
[2025-08-05 14:38:56,085] INFO [src.utils:19] 		Dataset#18 (dataset_parser=mmeb): WebQA, num_rows=17166, prob=0.9615384615384616
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank53: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank49: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank55: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank54: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank52: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank50: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank48: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:57,100] INFO [src.utils:10] rank51: Subsample /home/jianpengcheng/VLM2Vec/data/vlm2vec_train/MMEB-train to 28000 samples
[2025-08-05 14:38:58,152] INFO [src.utils:19] Loaded mmeb/MSCOCO dataset with 100000 samples
[2025-08-05 14:38:58,152] INFO [src.utils:19] 		Dataset#19 (dataset_parser=mmeb): MSCOCO, num_rows=100000, prob=1.9230769230769231
[2025-08-05 15:27:51,175] INFO [src.utils:19] Loaded vidore/vidore/colpali_train_set dataset with 118195 samples
[2025-08-05 15:27:51,176] INFO [src.utils:19] 		Dataset#20 (dataset_parser=vidore): colpali_train_set, num_rows=118195, prob=19.230769230769234
Downloading data:   0%|          | 0/37 [00:00<?, ?files/s]Downloading data:   3%|▎         | 1/37 [00:05<03:20,  5.57s/files]Downloading data:   5%|▌         | 2/37 [00:07<02:09,  3.69s/files]Downloading data:   8%|▊         | 3/37 [00:10<01:53,  3.33s/files]Downloading data:  11%|█         | 4/37 [00:13<01:38,  2.97s/files]Downloading data:  14%|█▎        | 5/37 [00:22<02:42,  5.08s/files]Downloading data:  16%|█▌        | 6/37 [00:27<02:37,  5.08s/files]Downloading data:  19%|█▉        | 7/37 [00:32<02:38,  5.28s/files]Downloading data:  22%|██▏       | 8/37 [00:34<01:57,  4.05s/files]Downloading data:  24%|██▍       | 9/37 [00:36<01:36,  3.44s/files]Downloading data:  27%|██▋       | 10/37 [00:39<01:26,  3.19s/files]Downloading data:  30%|██▉       | 11/37 [00:41<01:14,  2.85s/files]Downloading data:  32%|███▏      | 12/37 [00:45<01:21,  3.27s/files]Downloading data:  35%|███▌      | 13/37 [00:50<01:35,  3.96s/files]Downloading data:  38%|███▊      | 14/37 [00:52<01:18,  3.40s/files]Downloading data:  41%|████      | 15/37 [01:00<01:38,  4.50s/files]Downloading data:  43%|████▎     | 16/37 [01:05<01:39,  4.74s/files]Downloading data:  46%|████▌     | 17/37 [01:07<01:19,  3.99s/files]Downloading data:  49%|████▊     | 18/37 [01:09<01:01,  3.25s/files]Downloading data:  51%|█████▏    | 19/37 [01:11<00:51,  2.88s/files]Downloading data:  54%|█████▍    | 20/37 [01:12<00:41,  2.44s/files]Downloading data:  57%|█████▋    | 21/37 [01:18<00:56,  3.54s/files]Downloading data:  59%|█████▉    | 22/37 [01:28<01:22,  5.51s/files]Downloading data:  62%|██████▏   | 23/37 [01:34<01:18,  5.62s/files]Downloading data:  65%|██████▍   | 24/37 [01:38<01:06,  5.13s/files]Downloading data:  68%|██████▊   | 25/37 [01:40<00:49,  4.14s/files]Downloading data:  70%|███████   | 26/37 [01:47<00:54,  4.94s/files]Downloading data:  73%|███████▎  | 27/37 [01:49<00:40,  4.01s/files]Downloading data:  76%|███████▌  | 28/37 [01:54<00:41,  4.56s/files]Downloading data:  78%|███████▊  | 29/37 [01:59<00:37,  4.69s/files]Downloading data:  81%|████████  | 30/37 [02:07<00:38,  5.46s/files]Downloading data:  84%|████████▍ | 31/37 [02:09<00:26,  4.45s/files]Downloading data:  86%|████████▋ | 32/37 [02:11<00:18,  3.79s/files]Downloading data:  89%|████████▉ | 33/37 [02:13<00:13,  3.34s/files]Downloading data:  92%|█████████▏| 34/37 [02:20<00:13,  4.48s/files]Downloading data:  95%|█████████▍| 35/37 [02:26<00:09,  4.68s/files]Downloading data:  97%|█████████▋| 36/37 [02:34<00:05,  5.74s/files]Downloading data: 100%|██████████| 37/37 [02:39<00:00,  5.65s/files]Downloading data: 100%|██████████| 37/37 [02:39<00:00,  4.32s/files]
Generating train split:   0%|          | 0/122752 [00:00<?, ? examples/s]Generating train split:   0%|          | 100/122752 [00:00<07:44, 264.20 examples/s]Generating train split:   0%|          | 300/122752 [00:00<03:41, 552.90 examples/s]Generating train split:   1%|          | 700/122752 [00:00<02:03, 991.47 examples/s]Generating train split:   1%|          | 1100/122752 [00:01<01:41, 1196.37 examples/s]Generating train split:   1%|          | 1400/122752 [00:01<01:37, 1240.88 examples/s]Generating train split:   1%|▏         | 1600/122752 [00:01<01:48, 1120.55 examples/s]Generating train split:   2%|▏         | 2100/122752 [00:01<01:22, 1468.76 examples/s]Generating train split:   2%|▏         | 2500/122752 [00:01<01:07, 1768.77 examples/s]Generating train split:   2%|▏         | 2700/122752 [00:02<01:45, 1141.94 examples/s]Generating train split:   2%|▏         | 3000/122752 [00:02<01:38, 1217.56 examples/s]Generating train split:   3%|▎         | 3418/122752 [00:03<01:56, 1023.21 examples/s]Generating train split:   3%|▎         | 3818/122752 [00:03<01:33, 1266.37 examples/s]Generating train split:   3%|▎         | 4218/122752 [00:04<03:20, 591.30 examples/s] Generating train split:   4%|▍         | 4618/122752 [00:04<02:34, 764.45 examples/s]Generating train split:   4%|▍         | 5218/122752 [00:05<01:53, 1034.05 examples/s]Generating train split:   5%|▍         | 5718/122752 [00:05<01:26, 1351.36 examples/s]Generating train split:   5%|▌         | 6418/122752 [00:06<01:40, 1162.51 examples/s]Generating train split:   5%|▌         | 6736/122752 [00:06<01:34, 1232.48 examples/s]Generating train split:   6%|▌         | 7036/122752 [00:06<01:32, 1249.68 examples/s]Generating train split:   6%|▌         | 7236/122752 [00:06<01:33, 1241.32 examples/s]Generating train split:   6%|▌         | 7636/122752 [00:06<01:16, 1496.08 examples/s]Generating train split:   6%|▋         | 7936/122752 [00:08<03:53, 492.02 examples/s] Generating train split:   7%|▋         | 8336/122752 [00:08<02:47, 683.71 examples/s]Generating train split:   7%|▋         | 8736/122752 [00:08<02:15, 841.54 examples/s]Generating train split:   7%|▋         | 8936/122752 [00:09<02:14, 843.75 examples/s]Generating train split:   7%|▋         | 9136/122752 [00:09<02:15, 837.53 examples/s]Generating train split:   8%|▊         | 9536/122752 [00:09<01:43, 1092.84 examples/s]Generating train split:   8%|▊         | 9836/122752 [00:09<01:41, 1111.98 examples/s]Generating train split:   8%|▊         | 10054/122752 [00:10<01:45, 1067.13 examples/s]Generating train split:   8%|▊         | 10354/122752 [00:12<05:04, 369.49 examples/s] Generating train split:   9%|▉         | 11154/122752 [00:12<02:56, 631.72 examples/s]Generating train split:  10%|▉         | 11754/122752 [00:12<02:03, 897.16 examples/s]Generating train split:  10%|▉         | 12254/122752 [00:13<01:48, 1021.00 examples/s]Generating train split:  10%|█         | 12554/122752 [00:13<01:41, 1080.56 examples/s]Generating train split:  10%|█         | 12854/122752 [00:13<01:38, 1115.12 examples/s]Generating train split:  11%|█         | 13154/122752 [00:13<01:24, 1298.01 examples/s]Generating train split:  11%|█         | 13372/122752 [00:13<01:29, 1215.59 examples/s]Generating train split:  11%|█         | 13672/122752 [00:14<01:35, 1143.25 examples/s]Generating train split:  11%|█▏        | 13872/122752 [00:14<02:03, 885.02 examples/s] Generating train split:  11%|█▏        | 14072/122752 [00:16<04:51, 372.94 examples/s]Generating train split:  12%|█▏        | 14372/122752 [00:16<03:30, 515.52 examples/s]Generating train split:  12%|█▏        | 14772/122752 [00:16<02:22, 755.26 examples/s]Generating train split:  12%|█▏        | 15072/122752 [00:17<02:43, 658.01 examples/s]Generating train split:  13%|█▎        | 15472/122752 [00:17<02:15, 793.22 examples/s]Generating train split:  13%|█▎        | 16072/122752 [00:17<01:54, 929.55 examples/s]Generating train split:  13%|█▎        | 16272/122752 [00:18<02:08, 827.08 examples/s]Generating train split:  14%|█▎        | 16690/122752 [00:18<01:47, 984.85 examples/s]Generating train split:  14%|█▍        | 16990/122752 [00:20<04:01, 438.09 examples/s]Generating train split:  14%|█▍        | 17790/122752 [00:20<02:25, 723.46 examples/s]Generating train split:  15%|█▍        | 18290/122752 [00:20<01:49, 949.81 examples/s]Generating train split:  15%|█▌        | 18490/122752 [00:21<02:08, 813.40 examples/s]Generating train split:  15%|█▌        | 18690/122752 [00:21<02:05, 830.02 examples/s]Generating train split:  16%|█▌        | 19390/122752 [00:21<01:17, 1335.38 examples/s]Generating train split:  16%|█▋        | 20008/122752 [00:21<01:05, 1571.52 examples/s]Generating train split:  17%|█▋        | 20308/122752 [00:22<01:07, 1524.65 examples/s]Generating train split:  17%|█▋        | 20508/122752 [00:22<01:50, 928.76 examples/s] Generating train split:  17%|█▋        | 20708/122752 [00:23<03:28, 489.74 examples/s]Generating train split:  17%|█▋        | 21308/122752 [00:24<02:16, 740.63 examples/s]Generating train split:  18%|█▊        | 21808/122752 [00:24<01:43, 975.42 examples/s]Generating train split:  18%|█▊        | 22108/122752 [00:24<01:35, 1054.81 examples/s]Generating train split:  18%|█▊        | 22408/122752 [00:25<01:59, 839.20 examples/s] Generating train split:  19%|█▉        | 23326/122752 [00:25<01:11, 1390.28 examples/s]Generating train split:  19%|█▉        | 23926/122752 [00:25<00:58, 1695.80 examples/s]Generating train split:  20%|█▉        | 24526/122752 [00:26<01:00, 1622.91 examples/s]Generating train split:  20%|██        | 24826/122752 [00:26<01:02, 1554.66 examples/s]Generating train split:  21%|██        | 25526/122752 [00:26<00:51, 1905.01 examples/s]Generating train split:  21%|██        | 25926/122752 [00:27<01:44, 924.89 examples/s] Generating train split:  22%|██▏       | 26426/122752 [00:27<01:20, 1202.37 examples/s]Generating train split:  22%|██▏       | 26844/122752 [00:28<01:17, 1233.89 examples/s]Generating train split:  22%|██▏       | 27244/122752 [00:28<01:24, 1123.92 examples/s]Generating train split:  22%|██▏       | 27544/122752 [00:28<01:19, 1194.71 examples/s]Generating train split:  23%|██▎       | 27744/122752 [00:29<01:31, 1038.58 examples/s]Generating train split:  23%|██▎       | 27944/122752 [00:29<01:55, 818.87 examples/s] Generating train split:  23%|██▎       | 28644/122752 [00:29<01:12, 1290.57 examples/s]Generating train split:  24%|██▎       | 29044/122752 [00:29<01:02, 1487.82 examples/s]Generating train split:  24%|██▍       | 29244/122752 [00:30<01:26, 1085.96 examples/s]Generating train split:  24%|██▍       | 29544/122752 [00:31<02:47, 556.42 examples/s] Generating train split:  24%|██▍       | 29744/122752 [00:31<02:27, 630.42 examples/s]Generating train split:  24%|██▍       | 29962/122752 [00:32<02:57, 522.66 examples/s]Generating train split:  25%|██▍       | 30362/122752 [00:32<02:08, 718.22 examples/s]Generating train split:  25%|██▍       | 30562/122752 [00:32<02:05, 736.36 examples/s]Generating train split:  25%|██▌       | 30762/122752 [00:33<02:00, 763.41 examples/s]Generating train split:  25%|██▌       | 31262/122752 [00:34<02:23, 638.42 examples/s]Generating train split:  26%|██▌       | 31662/122752 [00:35<03:25, 443.15 examples/s]Generating train split:  26%|██▋       | 32362/122752 [00:35<01:58, 761.34 examples/s]Generating train split:  27%|██▋       | 32662/122752 [00:36<01:59, 752.30 examples/s]Generating train split:  27%|██▋       | 32962/122752 [00:36<01:47, 833.40 examples/s]Generating train split:  27%|██▋       | 33280/122752 [00:36<01:32, 963.86 examples/s]Generating train split:  27%|██▋       | 33480/122752 [00:36<01:47, 832.58 examples/s]Generating train split:  28%|██▊       | 33780/122752 [00:37<01:35, 934.96 examples/s]Generating train split:  28%|██▊       | 34480/122752 [00:37<01:05, 1357.00 examples/s]Generating train split:  28%|██▊       | 34780/122752 [00:37<01:08, 1278.17 examples/s]Generating train split:  28%|██▊       | 34980/122752 [00:39<02:50, 515.59 examples/s] Generating train split:  29%|██▊       | 35280/122752 [00:39<02:17, 634.96 examples/s]Generating train split:  29%|██▉       | 35480/122752 [00:39<02:12, 658.93 examples/s]Generating train split:  29%|██▉       | 35680/122752 [00:39<02:04, 697.40 examples/s]Generating train split:  29%|██▉       | 36180/122752 [00:39<01:20, 1079.66 examples/s]Generating train split:  30%|██▉       | 36380/122752 [00:40<01:13, 1182.09 examples/s]Generating train split:  30%|██▉       | 36598/122752 [00:40<01:18, 1104.34 examples/s]Generating train split:  30%|███       | 37198/122752 [00:40<00:52, 1623.51 examples/s]Generating train split:  31%|███       | 37698/122752 [00:40<01:03, 1344.80 examples/s]Generating train split:  31%|███       | 38098/122752 [00:41<00:57, 1462.70 examples/s]Generating train split:  31%|███▏      | 38498/122752 [00:41<00:54, 1538.58 examples/s]Generating train split:  32%|███▏      | 38898/122752 [00:42<02:02, 683.23 examples/s] Generating train split:  32%|███▏      | 39298/122752 [00:43<01:51, 751.41 examples/s]Generating train split:  33%|███▎      | 39916/122752 [00:43<01:21, 1022.58 examples/s]Generating train split:  33%|███▎      | 40116/122752 [00:43<01:25, 962.61 examples/s] Generating train split:  33%|███▎      | 40316/122752 [00:43<01:24, 971.96 examples/s]Generating train split:  33%|███▎      | 40816/122752 [00:44<00:59, 1383.35 examples/s]Generating train split:  34%|███▎      | 41216/122752 [00:44<01:08, 1191.58 examples/s]Generating train split:  34%|███▎      | 41416/122752 [00:44<01:13, 1100.91 examples/s]Generating train split:  34%|███▍      | 41716/122752 [00:44<01:07, 1199.73 examples/s]Generating train split:  34%|███▍      | 41916/122752 [00:45<01:13, 1099.48 examples/s]Generating train split:  34%|███▍      | 42316/122752 [00:45<01:15, 1061.07 examples/s]Generating train split:  35%|███▍      | 42616/122752 [00:46<02:22, 563.30 examples/s] Generating train split:  35%|███▌      | 43234/122752 [00:47<01:35, 836.76 examples/s]Generating train split:  35%|███▌      | 43434/122752 [00:47<01:51, 709.07 examples/s]Generating train split:  36%|███▌      | 43834/122752 [00:47<01:28, 893.04 examples/s]Generating train split:  36%|███▌      | 44434/122752 [00:47<01:03, 1225.01 examples/s]Generating train split:  36%|███▋      | 44734/122752 [00:48<01:02, 1246.51 examples/s]Generating train split:  37%|███▋      | 44934/122752 [00:48<01:27, 891.54 examples/s] Generating train split:  37%|███▋      | 45234/122752 [00:48<01:19, 975.65 examples/s]Generating train split:  37%|███▋      | 45434/122752 [00:50<02:59, 429.64 examples/s]Generating train split:  37%|███▋      | 45934/122752 [00:50<02:02, 628.03 examples/s]Generating train split:  38%|███▊      | 46552/122752 [00:50<01:23, 908.58 examples/s]Generating train split:  38%|███▊      | 46852/122752 [00:51<01:36, 790.50 examples/s]Generating train split:  38%|███▊      | 47252/122752 [00:51<01:21, 924.00 examples/s]Generating train split:  39%|███▊      | 47452/122752 [00:51<01:18, 965.06 examples/s]Generating train split:  39%|███▉      | 47652/122752 [00:52<01:53, 660.56 examples/s]Generating train split:  39%|███▉      | 48152/122752 [00:53<02:26, 509.00 examples/s]Generating train split:  40%|███▉      | 48552/122752 [00:54<01:56, 636.61 examples/s]Generating train split:  40%|███▉      | 48752/122752 [00:54<01:58, 626.75 examples/s]Generating train split:  40%|███▉      | 48852/122752 [00:54<02:01, 609.68 examples/s]Generating train split:  40%|███▉      | 49052/122752 [00:55<02:16, 539.11 examples/s]Generating train split:  41%|████      | 49870/122752 [00:55<01:08, 1068.57 examples/s]Generating train split:  41%|████      | 50370/122752 [00:55<00:57, 1252.72 examples/s]Generating train split:  42%|████▏     | 50970/122752 [00:56<00:58, 1218.90 examples/s]Generating train split:  42%|████▏     | 51270/122752 [00:56<00:56, 1264.92 examples/s]Generating train split:  42%|████▏     | 51470/122752 [00:57<02:02, 581.59 examples/s] Generating train split:  42%|████▏     | 52070/122752 [00:58<01:23, 847.92 examples/s]Generating train split:  43%|████▎     | 52370/122752 [00:58<01:34, 741.50 examples/s]Generating train split:  43%|████▎     | 52570/122752 [00:58<01:29, 782.56 examples/s]Generating train split:  43%|████▎     | 52770/122752 [00:58<01:21, 857.05 examples/s]Generating train split:  43%|████▎     | 53188/122752 [00:59<01:08, 1019.25 examples/s]Generating train split:  43%|████▎     | 53388/122752 [00:59<01:09, 997.44 examples/s] Generating train split:  44%|████▎     | 53688/122752 [00:59<01:05, 1062.47 examples/s]Generating train split:  44%|████▍     | 54288/122752 [00:59<00:42, 1595.79 examples/s]Generating train split:  44%|████▍     | 54588/122752 [01:00<00:47, 1431.26 examples/s]Generating train split:  45%|████▍     | 54888/122752 [01:01<02:01, 560.44 examples/s] Generating train split:  45%|████▍     | 55188/122752 [01:02<02:01, 557.62 examples/s]Generating train split:  45%|████▌     | 55488/122752 [01:02<01:43, 650.99 examples/s]Generating train split:  45%|████▌     | 55788/122752 [01:02<01:43, 644.69 examples/s]Generating train split:  46%|████▌     | 56506/122752 [01:03<01:04, 1033.46 examples/s]Generating train split:  46%|████▋     | 56906/122752 [01:03<00:54, 1197.81 examples/s]Generating train split:  47%|████▋     | 57406/122752 [01:03<00:47, 1370.61 examples/s]Generating train split:  47%|████▋     | 57806/122752 [01:03<00:45, 1429.00 examples/s]Generating train split:  47%|████▋     | 58106/122752 [01:03<00:44, 1459.00 examples/s]Generating train split:  48%|████▊     | 58406/122752 [01:04<00:44, 1457.67 examples/s]Generating train split:  48%|████▊     | 59006/122752 [01:04<00:37, 1701.83 examples/s]Generating train split:  49%|████▊     | 59606/122752 [01:05<01:12, 870.23 examples/s] Generating train split:  49%|████▊     | 59824/122752 [01:05<01:13, 858.24 examples/s]Generating train split:  49%|████▉     | 60424/122752 [01:06<01:08, 914.09 examples/s]Generating train split:  50%|████▉     | 60824/122752 [01:06<00:58, 1059.48 examples/s]Generating train split:  50%|█████     | 61424/122752 [01:07<00:46, 1325.22 examples/s]Generating train split:  50%|█████     | 61724/122752 [01:07<00:48, 1254.06 examples/s]Generating train split:  50%|█████     | 61924/122752 [01:07<00:49, 1232.11 examples/s]Generating train split:  51%|█████     | 62224/122752 [01:08<01:05, 923.68 examples/s] Generating train split:  51%|█████     | 62424/122752 [01:09<02:10, 462.04 examples/s]Generating train split:  51%|█████▏    | 63142/122752 [01:09<01:17, 771.03 examples/s]Generating train split:  52%|█████▏    | 63542/122752 [01:09<01:02, 947.56 examples/s]Generating train split:  52%|█████▏    | 63842/122752 [01:10<00:58, 1015.06 examples/s]Generating train split:  52%|█████▏    | 64242/122752 [01:10<00:51, 1132.52 examples/s]Generating train split:  53%|█████▎    | 64542/122752 [01:10<00:51, 1134.07 examples/s]Generating train split:  53%|█████▎    | 65042/122752 [01:10<00:43, 1341.02 examples/s]Generating train split:  54%|█████▎    | 65842/122752 [01:11<00:30, 1888.82 examples/s]Generating train split:  54%|█████▍    | 66460/122752 [01:11<00:39, 1432.65 examples/s]Generating train split:  54%|█████▍    | 66660/122752 [01:13<01:21, 687.76 examples/s] Generating train split:  55%|█████▍    | 67160/122752 [01:13<01:00, 925.27 examples/s]Generating train split:  55%|█████▌    | 67560/122752 [01:13<00:53, 1028.75 examples/s]Generating train split:  55%|█████▌    | 67860/122752 [01:13<00:48, 1122.57 examples/s]Generating train split:  56%|█████▌    | 68460/122752 [01:13<00:36, 1471.35 examples/s]Generating train split:  56%|█████▌    | 68960/122752 [01:14<00:39, 1356.75 examples/s]Generating train split:  56%|█████▋    | 69260/122752 [01:14<00:50, 1050.85 examples/s]Generating train split:  57%|█████▋    | 69778/122752 [01:15<00:57, 924.13 examples/s] Generating train split:  57%|█████▋    | 69978/122752 [01:17<01:59, 442.32 examples/s]Generating train split:  57%|█████▋    | 70378/122752 [01:17<01:34, 556.12 examples/s]Generating train split:  57%|█████▋    | 70578/122752 [01:17<01:24, 615.61 examples/s]Generating train split:  58%|█████▊    | 70778/122752 [01:18<01:29, 581.83 examples/s]Generating train split:  58%|█████▊    | 70978/122752 [01:18<01:20, 639.32 examples/s]Generating train split:  58%|█████▊    | 71078/122752 [01:18<01:40, 515.00 examples/s]Generating train split:  58%|█████▊    | 71478/122752 [01:18<01:11, 713.32 examples/s]Generating train split:  58%|█████▊    | 71578/122752 [01:20<02:37, 324.12 examples/s]Generating train split:  59%|█████▊    | 72078/122752 [01:20<01:48, 466.42 examples/s]Generating train split:  59%|█████▉    | 72478/122752 [01:21<01:18, 638.08 examples/s]Generating train split:  59%|█████▉    | 72678/122752 [01:21<01:11, 700.20 examples/s]Generating train split:  59%|█████▉    | 72878/122752 [01:21<01:12, 691.00 examples/s]Generating train split:  60%|█████▉    | 73096/122752 [01:21<01:06, 751.69 examples/s]Generating train split:  60%|██████    | 73796/122752 [01:22<00:38, 1278.86 examples/s]Generating train split:  61%|██████    | 74296/122752 [01:22<00:28, 1707.48 examples/s]Generating train split:  61%|██████    | 74696/122752 [01:22<00:37, 1265.66 examples/s]Generating train split:  61%|██████    | 74896/122752 [01:22<00:37, 1290.34 examples/s]Generating train split:  61%|██████▏   | 75196/122752 [01:23<00:34, 1392.26 examples/s]Generating train split:  62%|██████▏   | 75496/122752 [01:24<01:39, 476.95 examples/s] Generating train split:  62%|██████▏   | 76096/122752 [01:25<01:05, 715.98 examples/s]Generating train split:  62%|██████▏   | 76414/122752 [01:25<00:56, 814.62 examples/s]Generating train split:  63%|██████▎   | 76914/122752 [01:25<00:45, 1003.28 examples/s]Generating train split:  63%|██████▎   | 77114/122752 [01:25<00:42, 1065.79 examples/s]Generating train split:  63%|██████▎   | 77314/122752 [01:26<00:53, 852.90 examples/s] Generating train split:  63%|██████▎   | 77714/122752 [01:26<00:43, 1044.81 examples/s]Generating train split:  64%|██████▍   | 78714/122752 [01:26<00:23, 1847.36 examples/s]Generating train split:  64%|██████▍   | 79014/122752 [01:26<00:24, 1789.58 examples/s]Generating train split:  65%|██████▍   | 79731/122752 [01:27<00:22, 1943.71 examples/s]Generating train split:  65%|██████▌   | 80231/122752 [01:28<00:49, 856.34 examples/s] Generating train split:  66%|██████▌   | 80431/122752 [01:28<00:55, 765.06 examples/s]Generating train split:  66%|██████▌   | 80831/122752 [01:29<00:45, 912.18 examples/s]Generating train split:  66%|██████▌   | 81231/122752 [01:29<00:38, 1085.41 examples/s]Generating train split:  67%|██████▋   | 82131/122752 [01:29<00:22, 1778.11 examples/s]Generating train split:  68%|██████▊   | 83048/122752 [01:30<00:28, 1413.34 examples/s]Generating train split:  68%|██████▊   | 83448/122752 [01:30<00:30, 1273.93 examples/s]Generating train split:  68%|██████▊   | 83748/122752 [01:32<00:57, 674.26 examples/s] Generating train split:  69%|██████▊   | 84148/122752 [01:32<00:49, 786.14 examples/s]Generating train split:  69%|██████▊   | 84348/122752 [01:32<00:48, 786.52 examples/s]Generating train split:  69%|██████▉   | 84648/122752 [01:33<00:56, 670.31 examples/s]Generating train split:  69%|██████▉   | 84848/122752 [01:33<00:55, 688.69 examples/s]Generating train split:  69%|██████▉   | 85048/122752 [01:33<00:50, 753.00 examples/s]Generating train split:  69%|██████▉   | 85248/122752 [01:34<00:48, 778.13 examples/s]Generating train split:  70%|██████▉   | 85548/122752 [01:35<01:23, 445.92 examples/s]Generating train split:  70%|███████   | 86048/122752 [01:35<00:53, 682.54 examples/s]Generating train split:  70%|███████   | 86365/122752 [01:35<00:45, 805.81 examples/s]Generating train split:  71%|███████   | 86565/122752 [01:36<00:50, 722.75 examples/s]Generating train split:  71%|███████   | 86865/122752 [01:36<00:43, 830.01 examples/s]Generating train split:  71%|███████   | 87165/122752 [01:36<00:37, 942.59 examples/s]Generating train split:  72%|███████▏  | 87965/122752 [01:36<00:23, 1510.56 examples/s]Generating train split:  72%|███████▏  | 88365/122752 [01:37<00:21, 1568.28 examples/s]Generating train split:  72%|███████▏  | 88765/122752 [01:37<00:20, 1630.03 examples/s]Generating train split:  73%|███████▎  | 89682/122752 [01:37<00:16, 1981.50 examples/s]Generating train split:  73%|███████▎  | 89982/122752 [01:39<00:46, 708.01 examples/s] Generating train split:  74%|███████▎  | 90382/122752 [01:39<00:36, 897.80 examples/s]Generating train split:  74%|███████▍  | 90782/122752 [01:39<00:30, 1039.68 examples/s]Generating train split:  74%|███████▍  | 91082/122752 [01:39<00:27, 1153.99 examples/s]Generating train split:  75%|███████▍  | 91482/122752 [01:39<00:23, 1333.72 examples/s]Generating train split:  75%|███████▌  | 92182/122752 [01:40<00:30, 996.00 examples/s] Generating train split:  76%|███████▌  | 92682/122752 [01:41<00:23, 1273.99 examples/s]Generating train split:  76%|███████▌  | 92999/122752 [01:41<00:23, 1287.63 examples/s]Generating train split:  76%|███████▋  | 93699/122752 [01:41<00:17, 1633.40 examples/s]Generating train split:  77%|███████▋  | 94099/122752 [01:42<00:39, 734.16 examples/s] Generating train split:  77%|███████▋  | 94499/122752 [01:43<00:33, 831.56 examples/s]Generating train split:  77%|███████▋  | 94899/122752 [01:43<00:31, 886.89 examples/s]Generating train split:  77%|███████▋  | 95099/122752 [01:43<00:31, 888.82 examples/s]Generating train split:  78%|███████▊  | 95299/122752 [01:44<00:29, 925.01 examples/s]Generating train split:  78%|███████▊  | 95699/122752 [01:44<00:24, 1090.71 examples/s]Generating train split:  78%|███████▊  | 96316/122752 [01:44<00:19, 1388.97 examples/s]Generating train split:  79%|███████▊  | 96616/122752 [01:44<00:18, 1397.35 examples/s]Generating train split:  79%|███████▉  | 96816/122752 [01:45<00:21, 1229.12 examples/s]Generating train split:  79%|███████▉  | 97216/122752 [01:45<00:24, 1053.21 examples/s]Generating train split:  79%|███████▉  | 97416/122752 [01:46<00:56, 451.03 examples/s] Generating train split:  80%|███████▉  | 97716/122752 [01:47<00:41, 601.76 examples/s]Generating train split:  80%|████████  | 98416/122752 [01:47<00:24, 976.15 examples/s]Generating train split:  81%|████████  | 98916/122752 [01:47<00:20, 1173.96 examples/s]Generating train split:  81%|████████  | 99216/122752 [01:48<00:30, 783.12 examples/s] Generating train split:  81%|████████  | 99633/122752 [01:48<00:22, 1016.62 examples/s]Generating train split:  81%|████████▏ | 100033/122752 [01:49<00:24, 919.81 examples/s]Generating train split:  82%|████████▏ | 100333/122752 [01:50<00:41, 538.84 examples/s]Generating train split:  82%|████████▏ | 100933/122752 [01:50<00:27, 796.57 examples/s]Generating train split:  82%|████████▏ | 101233/122752 [01:50<00:24, 868.52 examples/s]Generating train split:  83%|████████▎ | 101633/122752 [01:51<00:25, 812.58 examples/s]Generating train split:  83%|████████▎ | 101933/122752 [01:51<00:24, 842.30 examples/s]Generating train split:  83%|████████▎ | 102133/122752 [01:51<00:23, 860.10 examples/s]Generating train split:  84%|████████▎ | 102533/122752 [01:52<00:18, 1109.01 examples/s]Generating train split:  84%|████████▍ | 102950/122752 [01:52<00:14, 1393.34 examples/s]Generating train split:  84%|████████▍ | 103250/122752 [01:52<00:14, 1343.84 examples/s]Generating train split:  84%|████████▍ | 103450/122752 [01:52<00:20, 961.10 examples/s] Generating train split:  85%|████████▍ | 104050/122752 [01:53<00:12, 1458.80 examples/s]Generating train split:  85%|████████▌ | 104350/122752 [01:54<00:33, 557.44 examples/s] Generating train split:  85%|████████▌ | 104750/122752 [01:54<00:26, 683.93 examples/s]Generating train split:  86%|████████▌ | 105050/122752 [01:55<00:23, 751.69 examples/s]Generating train split:  86%|████████▌ | 105250/122752 [01:55<00:21, 810.85 examples/s]Generating train split:  86%|████████▌ | 105650/122752 [01:55<00:16, 1010.92 examples/s]Generating train split:  86%|████████▋ | 105950/122752 [01:55<00:14, 1197.24 examples/s]Generating train split:  87%|████████▋ | 106267/122752 [01:55<00:13, 1266.43 examples/s]Generating train split:  87%|████████▋ | 106567/122752 [01:56<00:12, 1293.61 examples/s]Generating train split:  87%|████████▋ | 106767/122752 [01:56<00:12, 1243.37 examples/s]Generating train split:  87%|████████▋ | 106967/122752 [01:56<00:12, 1245.83 examples/s]Generating train split:  87%|████████▋ | 107167/122752 [01:56<00:17, 914.72 examples/s] Generating train split:  88%|████████▊ | 107667/122752 [01:58<00:28, 534.42 examples/s]Generating train split:  88%|████████▊ | 107967/122752 [01:58<00:22, 658.78 examples/s]Generating train split:  88%|████████▊ | 108467/122752 [01:58<00:15, 908.80 examples/s]Generating train split:  89%|████████▊ | 108667/122752 [01:58<00:15, 911.50 examples/s]Generating train split:  89%|████████▉ | 108967/122752 [01:59<00:15, 867.11 examples/s]Generating train split:  89%|████████▉ | 109584/122752 [01:59<00:10, 1286.79 examples/s]Generating train split:  90%|████████▉ | 110084/122752 [02:00<00:10, 1238.37 examples/s]Generating train split:  90%|████████▉ | 110384/122752 [02:00<00:10, 1235.07 examples/s]Generating train split:  90%|█████████ | 110684/122752 [02:00<00:09, 1241.46 examples/s]Generating train split:  90%|█████████ | 110884/122752 [02:01<00:23, 503.36 examples/s] Generating train split:  91%|█████████ | 111484/122752 [02:02<00:14, 753.34 examples/s]Generating train split:  91%|█████████ | 111784/122752 [02:02<00:16, 659.24 examples/s]Generating train split:  91%|█████████▏| 112184/122752 [02:03<00:15, 679.88 examples/s]Generating train split:  91%|█████████▏| 112284/122752 [02:03<00:15, 662.16 examples/s]Generating train split:  92%|█████████▏| 112901/122752 [02:03<00:09, 987.48 examples/s]Generating train split:  92%|█████████▏| 113301/122752 [02:04<00:07, 1193.79 examples/s]Generating train split:  92%|█████████▏| 113501/122752 [02:05<00:19, 476.09 examples/s] Generating train split:  93%|█████████▎| 114301/122752 [02:05<00:09, 858.61 examples/s]Generating train split:  93%|█████████▎| 114501/122752 [02:06<00:09, 829.63 examples/s]Generating train split:  94%|█████████▍| 115201/122752 [02:06<00:06, 1202.15 examples/s]Generating train split:  94%|█████████▍| 115501/122752 [02:06<00:05, 1208.54 examples/s]Generating train split:  94%|█████████▍| 115801/122752 [02:06<00:05, 1272.60 examples/s]Generating train split:  95%|█████████▍| 116001/122752 [02:06<00:05, 1265.50 examples/s]Generating train split:  95%|█████████▍| 116218/122752 [02:07<00:07, 910.75 examples/s] Generating train split:  95%|█████████▍| 116418/122752 [02:07<00:07, 855.00 examples/s]Generating train split:  95%|█████████▌| 116818/122752 [02:07<00:05, 1072.43 examples/s]Generating train split:  95%|█████████▌| 117118/122752 [02:09<00:14, 386.58 examples/s] Generating train split:  96%|█████████▌| 117518/122752 [02:09<00:09, 567.47 examples/s]Generating train split:  96%|█████████▌| 117718/122752 [02:10<00:07, 655.66 examples/s]Generating train split:  96%|█████████▌| 117918/122752 [02:10<00:08, 569.02 examples/s]Generating train split:  97%|█████████▋| 118518/122752 [02:10<00:04, 959.32 examples/s]Generating train split:  97%|█████████▋| 118718/122752 [02:11<00:04, 961.25 examples/s]Generating train split:  97%|█████████▋| 119418/122752 [02:11<00:02, 1164.85 examples/s]Generating train split:  98%|█████████▊| 119935/122752 [02:11<00:02, 1218.65 examples/s]Generating train split:  98%|█████████▊| 120535/122752 [02:13<00:03, 692.18 examples/s] Generating train split:  99%|█████████▊| 120935/122752 [02:13<00:02, 849.81 examples/s]Generating train split:  99%|█████████▊| 121135/122752 [02:13<00:01, 846.06 examples/s]Generating train split:  99%|█████████▉| 121435/122752 [02:13<00:01, 958.61 examples/s]Generating train split:  99%|█████████▉| 121835/122752 [02:14<00:00, 1050.92 examples/s]Generating train split:  99%|█████████▉| 122035/122752 [02:14<00:00, 985.45 examples/s] Generating train split: 100%|█████████▉| 122235/122752 [02:14<00:00, 987.86 examples/s]Generating train split: 100%|██████████| 122752/122752 [02:15<00:00, 903.58 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 11118 examples [00:01, 10448.18 examples/s]Generating train split: 22255 examples [00:01, 21027.84 examples/s]Generating train split: 33361 examples [00:01, 30646.02 examples/s]Generating train split: 44511 examples [00:01, 39704.94 examples/s]Generating train split: 55934 examples [00:01, 48796.06 examples/s]Generating train split: 67975 examples [00:01, 50858.26 examples/s]Generating train split: 79983 examples [00:02, 59533.40 examples/s]Generating train split: 92043 examples [00:02, 66405.22 examples/s]Generating train split: 104041 examples [00:02, 72903.31 examples/s]Generating train split: 116111 examples [00:02, 71912.29 examples/s]Generating train split: 128115 examples [00:02, 70378.30 examples/s]Generating train split: 140165 examples [00:02, 62104.68 examples/s]Generating train split: 152247 examples [00:03, 60029.15 examples/s]Generating train split: 164286 examples [00:03, 62281.45 examples/s]Generating train split: 176356 examples [00:03, 66717.03 examples/s]Generating train split: 188459 examples [00:03, 69454.46 examples/s]Generating train split: 200467 examples [00:03, 71103.77 examples/s]Generating train split: 212481 examples [00:03, 69400.32 examples/s]Generating train split: 224514 examples [00:04, 71073.63 examples/s]Generating train split: 236547 examples [00:04, 49876.64 examples/s]Generating train split: 248619 examples [00:04, 57801.44 examples/s]Generating train split: 260663 examples [00:04, 61307.73 examples/s]Generating train split: 272676 examples [00:04, 65832.36 examples/s]Generating train split: 284695 examples [00:05, 68720.51 examples/s]Generating train split: 296754 examples [00:05, 74500.20 examples/s]Generating train split: 301751 examples [00:06, 48099.76 examples/s]
[2025-08-05 15:33:07,985] INFO [src.utils:19] Loaded visrag/openbmb/VisRAG-Ret-Train-In-domain-data dataset with 122752 samples
[2025-08-05 15:33:07,986] INFO [src.utils:19] 		Dataset#21 (dataset_parser=visrag): visrag-indomain, num_rows=122752, prob=23.076923076923077
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 30820 examples [00:00, 98338.60 examples/s]Generating train split: 61639 examples [00:00, 123350.47 examples/s]Generating train split: 93165 examples [00:00, 138421.29 examples/s]Generating train split: 125704 examples [00:00, 152647.68 examples/s]Generating train split: 158260 examples [00:01, 164189.59 examples/s]Generating train split: 191956 examples [00:01, 167981.23 examples/s]Generating train split: 225627 examples [00:01, 174373.77 examples/s]Generating train split: 246753 examples [00:01, 165983.38 examples/s]Generating train split: 255000 examples [00:02, 115469.05 examples/s]
[2025-08-05 15:33:18,507] INFO [src.utils:19] Loaded llavahound_caption/video_caption_300k dataset with 301751 samples
[2025-08-05 15:33:18,507] INFO [src.utils:19] 		Dataset#22 (dataset_parser=llavahound_caption): video_caption_300k, num_rows=301751, prob=9.615384615384617
[2025-08-05 15:33:18,904] INFO [src.utils:19] Loaded llavahound_caption/video_caption_300k dataset with 301751 samples
[2025-08-05 15:33:18,904] INFO [src.utils:19] 		Dataset#23 (dataset_parser=llavahound_caption): video_caption_300k-video, num_rows=301751, prob=9.615384615384617
[2025-08-05 15:33:22,949] INFO [src.utils:19] Loaded llavahound_qa/video_qa_240k dataset with 255000 samples
[2025-08-05 15:33:22,949] INFO [src.utils:19] 		Dataset#24 (dataset_parser=llavahound_qa): video_qa_240k, num_rows=255000, prob=9.615384615384617
[2025-08-05 15:33:22,949] INFO [src.utils:19] 
Initializing interleave datasets:
		world_size=64
		total num rows=2167622
		global batch size=8192
		estimated num step per epoch=264.602294921875
		interleave_batch_size=512.0
[2025-08-05 15:33:22,965] INFO [src.utils:19] ==================================================
[2025-08-05 15:33:22,965] INFO [src.utils:19] Print the features of each dataset, make sure that all datasets have valid features.
[2025-08-05 15:33:22,966] INFO [src.utils:19] 		Dataset 0 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,967] INFO [src.utils:19] 		Dataset 1 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,967] INFO [src.utils:19] 		Dataset 2 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,968] INFO [src.utils:19] 		Dataset 3 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,969] INFO [src.utils:19] 		Dataset 4 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,969] INFO [src.utils:19] 		Dataset 5 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,970] INFO [src.utils:19] 		Dataset 6 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,971] INFO [src.utils:19] 		Dataset 7 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,972] INFO [src.utils:19] 		Dataset 8 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,972] INFO [src.utils:19] 		Dataset 9 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,973] INFO [src.utils:19] 		Dataset 10 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,974] INFO [src.utils:19] 		Dataset 11 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,974] INFO [src.utils:19] 		Dataset 12 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,975] INFO [src.utils:19] 		Dataset 13 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,976] INFO [src.utils:19] 		Dataset 14 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,976] INFO [src.utils:19] 		Dataset 15 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,977] INFO [src.utils:19] 		Dataset 16 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,978] INFO [src.utils:19] 		Dataset 17 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,979] INFO [src.utils:19] 		Dataset 18 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,979] INFO [src.utils:19] 		Dataset 19 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,980] INFO [src.utils:19] 		Dataset 20 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,981] INFO [src.utils:19] 		Dataset 21 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,981] INFO [src.utils:19] 		Dataset 22 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,982] INFO [src.utils:19] 		Dataset 23 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,983] INFO [src.utils:19] 		Dataset 24 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name', 'task_id']
[2025-08-05 15:33:22,983] INFO [src.utils:19] ==================================================
[2025-08-05 15:33:23,060] INFO [src.utils:19] World size: 64
[2025-08-05 15:34:21,359] INFO [src.utils:10] rank0: init wandb
wandb: Currently logged in as: cheng6076 (cheng6076-apple) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.21.0
wandb: Run data is saved locally in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/wandb/run-20250805_153421-zdf77mzz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run qwen2-2b_v2_imageonly_chat_lr2e-4_ntokens16_8x8_472397
wandb: ⭐️ View project at https://wandb.ai/cheng6076-apple/VLM2Vec
wandb: 🚀 View run at https://wandb.ai/cheng6076-apple/VLM2Vec/runs/zdf77mzz
[2025-08-05 15:34:25,677] INFO [src.utils:19] model_args: {
  "model_name": "Qwen/Qwen2-VL-2B-Instruct",
  "model_type": null,
  "processor_name": null,
  "model_backbone": "qwen2_vl",
  "checkpoint_path": null,
  "pooling_module": "eos",
  "normalize": true,
  "temperature": 0.02,
  "lora": true,
  "lora_r": 16,
  "lora_alpha": 64,
  "lora_dropout": 0.1,
  "lora_target_modules": "qkv_proj,o_proj,gate_up_proj,down_proj,k_proj,q_proj,out_proj,v_proj",
  "num_crops": 16,
  "uigraph_use": false,
  "uigraph_diff": 1,
  "uigraph_rand": false,
  "uimask_ratio": 0.5,
  "uimask_rand": false,
  "lm_skip_layer": "[1,28,0]",
  "vis_skip_layer": "[1,32,0]",
  "sft_checkpoint_path": null,
  "freeze_base_model": false,
  "do_sft_query": false,
  "do_cl": true,
  "do_sft_target": false,
  "pooling_n_queries": 4,
  "pooling_n_heads": 8,
  "mask_visual_tokens_for_pooling": false,
  "num_pooling_layers": 4,
  "pooling_last_n_layers": null,
  "meta_queries": null,
  "meta_queries_aggregate_type": "mean"
}
[2025-08-05 15:34:25,678] INFO [src.utils:19] data_args: {
  "dataset_config": "configs/train/train_alltasks.yaml",
  "data_basedir": null,
  "dataset_name": null,
  "subset_name": null,
  "dataset_split": "train",
  "num_sample_per_subset": null,
  "image_dir": null,
  "encode_output_path": null,
  "max_len": null,
  "embedding_type": "",
  "image_resolution": null,
  "resize_use_processor": true,
  "resize_min_pixels": 3136,
  "resize_max_pixels": 1003520,
  "image_decay_factor": null,
  "num_hardneg": 0,
  "use_cot": true,
  "max_desc_len": 1024,
  "query_description_dir": null,
  "apply_chat_template": false,
  "target_description_dir": null
}
[2025-08-05 15:34:32,511] INFO [src.utils:19] ***** Running training *****
[2025-08-05 15:34:32,512] INFO [src.utils:19]   Num examples = 2,162,688
[2025-08-05 15:34:32,513] INFO [src.utils:19]   Num Epochs = 9,223,372,036,854,775,807
[2025-08-05 15:34:32,513] INFO [src.utils:19]   Instantaneous batch size per device = 128
[2025-08-05 15:34:32,514] INFO [src.utils:19]   Total train batch size (w. parallel, distributed & accumulation) = 8,192
[2025-08-05 15:34:32,514] INFO [src.utils:19]   Gradient Accumulation steps = 1
[2025-08-05 15:34:32,515] INFO [src.utils:19]   Total optimization steps = 264
[2025-08-05 15:34:32,524] INFO [src.utils:19]   Number of trainable parameters = 9,203,712
W0805 22:50:38.052664 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1341] The node 'a100-st2-p4de24xlarge-51.681858026951857.hpcaas_1643544_0' has failed to send a keep-alive heartbeat to the rendezvous '13173' due to an error of type RendezvousTimeoutError.
[rank58]: Traceback (most recent call last):
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1284, in _try_get_data
[rank58]:     data = self._data_queue.get(timeout=timeout)
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/queue.py", line 180, in get
[rank58]:     self.not_empty.wait(remaining)
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/threading.py", line 316, in wait
[rank58]:     gotit = waiter.acquire(True, timeout)
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
[rank58]:     _error_if_any_worker_fails()
[rank58]: RuntimeError: DataLoader worker (pid 1716222) is killed by signal: Killed. 

[rank58]: The above exception was the direct cause of the following exception:

[rank58]: Traceback (most recent call last):
[rank58]:   File "/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/train.py", line 185, in <module>
[rank58]:     main()
[rank58]:   File "/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/train.py", line 177, in main
[rank58]:     trainer.train(resume_from_checkpoint=resume_checkpoint_dir)
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/transformers/trainer.py", line 2240, in train
[rank58]:     return inner_training_loop(
[rank58]:   File "/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/trainer.py", line 441, in _inner_training_loop
[rank58]:     batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches)
[rank58]:   File "/opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/VLM2Vec/src/trainer.py", line 90, in get_batch_samples
[rank58]:     batch_samples += [next(epoch_iterator)]
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
[rank58]:     data = self._next_data()
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1491, in _next_data
[rank58]:     idx, data = self._get_data()
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1443, in _get_data
[rank58]:     success, data = self._try_get_data()
[rank58]:   File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1297, in _try_get_data
[rank58]:     raise RuntimeError(
[rank58]: RuntimeError: DataLoader worker (pid(s) 1716222) exited unexpectedly
W0805 22:51:54.149169 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644272 closing signal SIGTERM
W0805 22:51:54.162027 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644273 closing signal SIGTERM
W0805 22:51:54.164049 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644275 closing signal SIGTERM
W0805 22:51:54.164798 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644276 closing signal SIGTERM
W0805 22:51:54.166661 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644277 closing signal SIGTERM
W0805 22:51:54.167480 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644278 closing signal SIGTERM
W0805 22:51:54.172671 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1644279 closing signal SIGTERM
E0805 22:51:54.182812 1643544 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:874] failed (exitcode: 1) local_rank: 2 (pid: 1644274) of binary: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 270, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-08-05_22:51:54
  host      : a100-st2-p4de24xlarge-51.681858026951857.hpcaas
  rank      : 58 (local_rank: 2)
  exitcode  : 1 (pid: 1644274)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
W0805 22:52:10.100488 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1341] The node 'a100-st2-p4de24xlarge-1.681858026951857.hpcaas_4157461_0' has failed to send a keep-alive heartbeat to the rendezvous '13173' due to an error of type RendezvousTimeoutError.
srun: error: a100-st2-p4de24xlarge-51: task 7: Exited with exit code 1
srun: Terminating StepId=472397.0
  0%|          | 0/264 [00:00<?, ?it/s]slurmstepd: error: *** STEP 472397.0 ON a100-st2-p4de24xlarge-0 CANCELLED AT 2025-08-05T22:52:27 ***
W0805 22:52:27.533745 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py:719] Received Signals.SIGTERM death signal, shutting down workers
W0805 22:52:27.536257 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py:719] Received Signals.SIGTERM death signal, shutting down workers
W0805 22:52:27.534002 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py:719] Received Signals.SIGTERM death signal, shutting down workers
W0805 22:52:27.549664 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355950 closing signal SIGTERM
W0805 22:52:27.556063 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355951 closing signal SIGTERM
W0805 22:52:27.556529 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355952 closing signal SIGTERM
W0805 22:52:27.556950 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355953 closing signal SIGTERM
W0805 22:52:27.560919 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355954 closing signal SIGTERM
W0805 22:52:27.561391 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355955 closing signal SIGTERM
W0805 22:52:27.561796 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355956 closing signal SIGTERM
W0805 22:52:27.562216 3355654 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3355957 closing signal SIGTERM
W0805 22:52:27.554923 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195624 closing signal SIGTERM
W0805 22:52:27.562727 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195625 closing signal SIGTERM
W0805 22:52:27.555832 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596149 closing signal SIGTERM
W0805 22:52:27.561848 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596150 closing signal SIGTERM
W0805 22:52:27.562290 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596151 closing signal SIGTERM
W0805 22:52:27.562721 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596152 closing signal SIGTERM
W0805 22:52:27.563101 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596153 closing signal SIGTERM
W0805 22:52:27.563631 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596154 closing signal SIGTERM
W0805 22:52:27.563525 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195626 closing signal SIGTERM
W0805 22:52:27.565405 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195627 closing signal SIGTERM
W0805 22:52:27.564131 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596155 closing signal SIGTERM
W0805 22:52:27.567198 2595380 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2596156 closing signal SIGTERM
W0805 22:52:27.569789 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195628 closing signal SIGTERM
W0805 22:52:27.570358 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195629 closing signal SIGTERM
W0805 22:52:27.570889 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195630 closing signal SIGTERM
W0805 22:52:27.578364 1194852 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1195631 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    result = agent.run()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 870, in _invoke_run
    result = agent.run()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    time.sleep(monitor_interval)
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 1194852 got signal: 15
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    result = agent.run()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 870, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 3355654 got signal: 15
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 870, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2595380 got signal: 15
srun: error: a100-st2-p4de24xlarge-0: task 0: Exited with exit code 1
srun: error: a100-st2-p4de24xlarge-2: task 2: Exited with exit code 1
srun: error: a100-st2-p4de24xlarge-39: task 5: Exited with exit code 1
W0805 22:53:10.391905 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1341] The node 'a100-st2-p4de24xlarge-50.681858026951857.hpcaas_2575215_0' has failed to send a keep-alive heartbeat to the rendezvous '13173' due to an error of type RendezvousTimeoutError.
W0805 22:53:10.558906 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575590 closing signal SIGTERM
W0805 22:53:10.561839 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575591 closing signal SIGTERM
W0805 22:53:10.562324 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575592 closing signal SIGTERM
W0805 22:53:10.562723 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575593 closing signal SIGTERM
W0805 22:53:10.563295 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575594 closing signal SIGTERM
W0805 22:53:10.563805 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575595 closing signal SIGTERM
W0805 22:53:10.564180 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575596 closing signal SIGTERM
W0805 22:53:10.568532 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2575597 closing signal SIGTERM
[rank54]:[W805 15:53:10.453360327 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37754, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7541bef785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7541a86d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7541a86d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7541a86d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7541a86d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x754169dd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x754159befbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7541c0094ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7541c0126850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank51]:[W805 15:53:10.453613623 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37806, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x78b3147785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x78b2fded6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x78b2fded8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x78b2fded984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x78b2fded32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x78b2bf5d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x78b2af3efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x78b315894ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x78b315926850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank55]:[W805 15:53:10.457744059 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37774, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x759f89d785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x759f730d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x759f730d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x759f730d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x759f730d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x759f347d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x759f245efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x759f8ac94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x759f8ad26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank53]:[W805 15:53:10.453447166 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37790, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x75ce547785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x75ce3ded6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x75ce3ded8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x75ce3ded984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x75ce3ded32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x75cdff5d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x75cdef3efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x75ce55894ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x75ce55926850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank48]:[W805 15:53:10.453525516 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37784, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7bf3cbd785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7bf3b54d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7bf3b54d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7bf3b54d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7bf3b54d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7bf376bd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7bf3669efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7bf3cce94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7bf3ccf26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank50]:[W805 15:53:10.453209141 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37818, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7e3ce9d785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7e3cd34d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7e3cd34d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7e3cd34d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7e3cd34d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7e3c94bd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7e3c849efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7e3ceae94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7e3ceaf26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank49]:[W805 15:53:10.453693253 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37828, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7ef45ad785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7ef4444d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7ef4444d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7ef4444d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7ef4444d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7ef405bd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7ef3f59efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7ef45be94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7ef45bf26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank52]:[W805 15:53:10.455074426 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:37758, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7bcede9785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7bcec7cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7bcec7cd8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7bcec7cd984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7bcec7cd32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7bce893d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7bce791efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7bcedf894ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7bcedf926850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank50]:[W805 15:53:10.602765696 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 50] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank51]:[W805 15:53:10.602884893 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 51] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank53]:[W805 15:53:10.602805830 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 53] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank48]:[W805 15:53:10.602961212 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 48] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank54]:[W805 15:53:10.602722444 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 54] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank52]:[W805 15:53:10.602557119 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 52] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank49]:[W805 15:53:10.602923748 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 49] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank55]:[W805 15:53:10.602845136 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 55] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[W805 22:53:10.707909458 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:47504, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7bb7cbd785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7bb7b54d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x7bb7b54d8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x7bb7b54d9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x7bb7b54d3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7bb7b54d3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x7bb7b54d508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x7bb7c437f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x7bb7c3adf4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #28: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #30: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #31: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #33: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #34: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #36: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #37: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #38: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #39: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #40: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #42: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #43: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #45: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #47: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #49: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #52: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #53: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #54: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #55: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #56: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #57: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #58: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #59: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #60: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #61: <unknown function> + 0x29d90 (0x7bb7cce29d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #62: __libc_start_main + 0x80 (0x7bb7cce29e40 in /lib/x86_64-linux-gnu/libc.so.6)

W0805 22:53:10.759197 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-50.681858026951857.hpcaas_2575215_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
[W805 22:53:10.785045332 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-50.681858026951857.hpcaas]:47504, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7bb7cbd785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7bb7b54d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x7bb7b54d8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x7bb7b54d9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x7bb7b54d3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7bb7b54d3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x7bb7b54d508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x7bb7c437f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x7bb7c3adf4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #28: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #30: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #31: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #33: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #34: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #36: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #37: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #38: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #39: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #40: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #42: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #43: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #45: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #47: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #49: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #52: <unknown function> + 0x29d90 (0x7bb7cce29d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #53: __libc_start_main + 0x80 (0x7bb7cce29e40 in /lib/x86_64-linux-gnu/libc.so.6)
frame #54: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5875ae]

W0805 22:53:10.806785 2575215 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-50.681858026951857.hpcaas_2575215_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
torch.distributed.DistNetworkError: failed to recv, got 0 bytes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    result = agent.run()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 906, in _invoke_run
    num_nodes_waiting = rdzv_handler.num_nodes_waiting()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1263, in num_nodes_waiting
    self._state_holder.sync()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 437, in sync
    get_response = self._backend.get_state()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 75, in get_state
    base64_state: bytes = self._call_store("get", self._key)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 119, in _call_store
    raise RendezvousConnectionError(
torch.distributed.elastic.rendezvous.api.RendezvousConnectionError: The connection to the C10d store has failed. See inner exception for details.
[rank36]:[W805 15:53:27.165302076 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank34]:[W805 15:53:27.165370331 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank37]:[W805 15:53:27.165189324 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank32]:[W805 15:53:27.165492171 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank33]:[W805 15:53:27.165299334 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank35]:[W805 15:53:27.165316944 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank38]:[W805 15:53:27.165419914 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank39]:[W805 15:53:27.165340507 socket.cpp:200] [c10d] The hostname of the client socket cannot be retrieved. err=-3
[rank32]:[W805 15:52:43.472375615 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:17631, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7146a55785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x71468ecd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x71468ecd8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x71468ecd984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x71468ecd32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7146503d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7146401efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7146a6694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7146a6726850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank38]:[W805 15:52:44.631991819 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:48095, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7e3c1c5785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7e3c05cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7e3c05cd8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7e3c05cd984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7e3c05cd32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7e3bc73d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7e3bb71efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7e3c1d694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7e3c1d726850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank33]:[W805 15:52:44.801753542 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:42399, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x70ba063785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x70b9ef6d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x70b9ef6d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x70b9ef6d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x70b9ef6d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x70b9b0dd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x70b9a0befbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x70ba07294ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x70ba07326850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank36]:[W805 15:52:51.358335343 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:959, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x75f7645785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x75f74d8d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x75f74d8d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x75f74d8d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x75f74d8d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x75f70efd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x75f6fedefbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x75f765294ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x75f765326850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank34]:[W805 15:52:44.794872588 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:15647, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x73aa9db785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x73aa86ed6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x73aa86ed8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x73aa86ed984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x73aa86ed32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x73aa485d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x73aa383efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x73aa9ea94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x73aa9eb26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank39]:[W805 15:52:43.472386857 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:60639, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x73ab4d5785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x73ab36cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x73ab36cd8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x73ab36cd984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x73ab36cd32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x73aaf83d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x73aae81efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x73ab4e694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x73ab4e726850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank35]:[W805 15:52:47.864096017 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:49151, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7a2c24d785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7a2c0e0d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7a2c0e0d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7a2c0e0d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7a2c0e0d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7a2bcf7d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7a2bbf5efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7a2c25a94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7a2c25b26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank37]:[W805 15:52:51.755302930 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[fdff:ffff::]:37407, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7f71f29785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7f71dc0d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7f71dc0d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7f71dc0d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7f71dc0d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7f719d7d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7f718d5efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7f71f3a94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7f71f3b26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank35]:[W805 15:53:27.345189875 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 35] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank37]:[W805 15:53:27.345280932 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 37] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank34]:[W805 15:53:27.345046968 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 34] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank33]:[W805 15:53:27.345236549 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 33] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank32]:[W805 15:53:27.345301136 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 32] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank36]:[W805 15:53:27.345152181 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 36] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank38]:[W805 15:53:27.345261126 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 38] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank39]:[W805 15:53:27.345215756 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 39] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
W0805 22:53:27.495481 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1341] The node 'a100-st2-p4de24xlarge-38.681858026951857.hpcaas_3260029_0' has failed to send a keep-alive heartbeat to the rendezvous '13173' due to an error of type RendezvousTimeoutError.
W0805 22:53:28.178390 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260392 closing signal SIGTERM
W0805 22:53:28.181288 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260393 closing signal SIGTERM
W0805 22:53:28.181680 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260394 closing signal SIGTERM
W0805 22:53:28.182002 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260395 closing signal SIGTERM
W0805 22:53:28.182319 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260396 closing signal SIGTERM
W0805 22:53:28.182613 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260397 closing signal SIGTERM
W0805 22:53:28.182903 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260398 closing signal SIGTERM
W0805 22:53:28.185977 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 3260399 closing signal SIGTERM
[W805 22:53:28.930716285 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-38.681858026951857.hpcaas]:57336, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7ba9897785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7ba972ad6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x7ba972ad8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x7ba972ad9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x7ba972ad3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7ba972ad3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x7ba972ad508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x7ba98197f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x7ba9810df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #28: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #30: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #31: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #33: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #34: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #36: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #37: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #38: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #39: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #40: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #42: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #43: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #45: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #47: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #49: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #52: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #53: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #54: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #55: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #56: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #57: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #58: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #59: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #60: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #61: <unknown function> + 0x29d90 (0x7ba98a629d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #62: __libc_start_main + 0x80 (0x7ba98a629e40 in /lib/x86_64-linux-gnu/libc.so.6)

W0805 22:53:28.404692 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-38.681858026951857.hpcaas_3260029_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
[W805 22:53:28.091314108 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-38.681858026951857.hpcaas]:57336, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7ba9897785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7ba972ad6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x7ba972ad8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x7ba972ad9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x7ba972ad3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7ba972ad3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x7ba972ad508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x7ba98197f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x7ba9810df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #28: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #30: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #31: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #33: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #34: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #36: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #37: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #38: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #39: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #40: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #42: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #43: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #45: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #47: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #49: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #52: <unknown function> + 0x29d90 (0x7ba98a629d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #53: __libc_start_main + 0x80 (0x7ba98a629e40 in /lib/x86_64-linux-gnu/libc.so.6)
frame #54: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5875ae]

W0805 22:53:28.454335 3260029 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-38.681858026951857.hpcaas_3260029_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
torch.distributed.DistNetworkError: failed to recv, got 0 bytes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    result = agent.run()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 906, in _invoke_run
    num_nodes_waiting = rdzv_handler.num_nodes_waiting()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1263, in num_nodes_waiting
    self._state_holder.sync()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 437, in sync
    get_response = self._backend.get_state()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 75, in get_state
    base64_state: bytes = self._call_store("get", self._key)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 119, in _call_store
    raise RendezvousConnectionError(
torch.distributed.elastic.rendezvous.api.RendezvousConnectionError: The connection to the C10d store has failed. See inner exception for details.
srun: error: a100-st2-p4de24xlarge-50: task 6: Terminated
W0805 22:53:55.047522 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158214 closing signal SIGTERM
W0805 22:53:55.062658 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158215 closing signal SIGTERM
W0805 22:53:55.063117 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158216 closing signal SIGTERM
W0805 22:53:55.063469 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158217 closing signal SIGTERM
W0805 22:53:55.063846 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158218 closing signal SIGTERM
W0805 22:53:55.064192 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158219 closing signal SIGTERM
W0805 22:53:55.064525 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158220 closing signal SIGTERM
W0805 22:53:55.064876 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 4158221 closing signal SIGTERM
[W805 22:53:54.261843911 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-1.681858026951857.hpcaas]:37332, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x77a22f9785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x77a218cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x77a218cd8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x77a218cd9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x77a218cd3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x77a218cd3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x77a218cd508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x77a227b7f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x77a2272df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #28: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #30: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #31: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #32: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #33: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #34: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x504f95]
frame #35: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5dcd15]
frame #36: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5dcb94]
frame #37: <unknown function> + 0x94ac3 (0x77a230694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #38: <unknown function> + 0x126850 (0x77a230726850 in /lib/x86_64-linux-gnu/libc.so.6)

W0805 22:53:55.666421 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1341] The node 'a100-st2-p4de24xlarge-1.681858026951857.hpcaas_4157461_0' has failed to send a keep-alive heartbeat to the rendezvous '13173' due to an error of type RendezvousConnectionError.
[W805 22:53:55.025888929 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-1.681858026951857.hpcaas]:37332, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x77a22f9785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x77a218cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x77a218cd8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x77a218cd9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x77a218cd3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x77a218cd3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x77a218cd508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x77a227b7f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x77a2272df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #28: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #30: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #31: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #33: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #34: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #36: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #37: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #38: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #39: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #40: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #42: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #43: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #45: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #47: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #49: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #52: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #53: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #54: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #55: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #56: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #57: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #58: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #59: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #60: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #61: <unknown function> + 0x29d90 (0x77a230629d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #62: __libc_start_main + 0x80 (0x77a230629e40 in /lib/x86_64-linux-gnu/libc.so.6)

W0805 22:53:55.718517 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-1.681858026951857.hpcaas_4157461_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
[W805 22:53:55.101332840 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-1.681858026951857.hpcaas]:37332, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x77a22f9785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x77a218cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x77a218cd8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x77a218cd9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x77a218cd3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x77a218cd3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x77a218cd508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x77a227b7f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x77a2272df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #28: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #30: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #31: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #33: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #34: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #36: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #37: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #38: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #39: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #40: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #42: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #43: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #45: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #47: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #49: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #52: <unknown function> + 0x29d90 (0x77a230629d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #53: __libc_start_main + 0x80 (0x77a230629e40 in /lib/x86_64-linux-gnu/libc.so.6)
frame #54: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5875ae]

W0805 22:53:55.779814 4157461 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-1.681858026951857.hpcaas_4157461_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
torch.distributed.DistNetworkError: failed to recv, got 0 bytes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    result = agent.run()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 906, in _invoke_run
    num_nodes_waiting = rdzv_handler.num_nodes_waiting()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1263, in num_nodes_waiting
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 437, in sync
    get_response = self._backend.get_state()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 75, in get_state
    base64_state: bytes = self._call_store("get", self._key)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 119, in _call_store
    raise RendezvousConnectionError(
torch.distributed.elastic.rendezvous.api.RendezvousConnectionError: The connection to the C10d store has failed. See inner exception for details.
srun: error: a100-st2-p4de24xlarge-38: task 4: Terminated
srun: error: a100-st2-p4de24xlarge-1: task 1: Exited with exit code 1
[rank29]:[W805 15:52:36.597350727 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48418, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x74b78e1785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x74b7778d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x74b7778d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x74b7778d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x74b7778d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x74b738fd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x74b728defbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x74b78f294ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x74b78f326850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank26]:[W805 15:52:36.597786969 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48428, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7eb56b1785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7eb5544d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7eb5544d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7eb5544d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7eb5544d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7eb515bd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7eb5059efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7eb56c094ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7eb56c126850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank31]:[W805 15:52:38.998414082 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48400, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x784f53d785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x784f3d4d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x784f3d4d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x784f3d4d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x784f3d4d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x784efebd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x784eee9efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x784f54e94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x784f54f26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank24]:[W805 15:52:36.597512515 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48388, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7c79745785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7c795d8d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7c795d8d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7c795d8d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7c795d8d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7c791efd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7c790edefbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7c7975494ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7c7975526850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank27]:[W805 15:52:36.597484485 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48444, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7bee395785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7bee22cd6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7bee22cd8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7bee22cd984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7bee22cd32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7bede43d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7bedd41efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7bee3a694ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7bee3a726850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank28]:[W805 15:52:36.597485019 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48396, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x776658d785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7766424d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7766424d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7766424d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7766424d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x776603bd19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7765f39efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x776659e94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x776659f26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank30]:[W805 15:52:36.597516344 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48376, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x75fc9ad785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x75fc840d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x75fc840d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x75fc840d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x75fc840d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x75fc457d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x75fc355efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x75fc9bc94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x75fc9bd26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank25]:[W805 15:52:36.597384738 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=74, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:48408, remote=[ip-10-200-106-176.ec2.internal]:45333): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7d8e52b785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7d8e3c2d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baaf40 (0x7d8e3c2d8f40 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5bab84a (0x7d8e3c2d984a in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7d8e3c2d32a9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x379 (0x7d8dfd9d19f9 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xdbbf4 (0x7d8ded7efbf4 in /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/bin/../lib/libstdc++.so.6)
frame #7: <unknown function> + 0x94ac3 (0x7d8e53c94ac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126850 (0x7d8e53d26850 in /lib/x86_64-linux-gnu/libc.so.6)

[rank27]:[W805 15:54:32.839575176 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 27] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank30]:[W805 15:54:32.839535514 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 30] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank25]:[W805 15:54:32.839574454 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 25] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank24]:[W805 15:54:32.839494753 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 24] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank28]:[W805 15:54:32.839383945 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 28] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank31]:[W805 15:54:32.839496048 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 31] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank26]:[W805 15:54:32.839535750 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 26] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank29]:[W805 15:54:32.839390967 ProcessGroupNCCL.cpp:1662] [PG ID 0 PG GUID 0(default_pg) Rank 29] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
W0805 22:54:32.197186 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719036 closing signal SIGTERM
W0805 22:54:32.210058 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719037 closing signal SIGTERM
W0805 22:54:32.210645 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719038 closing signal SIGTERM
W0805 22:54:32.211144 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719039 closing signal SIGTERM
W0805 22:54:32.211608 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719040 closing signal SIGTERM
W0805 22:54:32.212066 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719041 closing signal SIGTERM
W0805 22:54:32.212509 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719042 closing signal SIGTERM
W0805 22:54:32.212869 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/api.py:900] Sending process 1719043 closing signal SIGTERM
[W805 22:54:32.072377438 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:58194, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7128c79785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7128b10d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x7128b10d8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x7128b10d9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x7128b10d3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7128b10d3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x7128b10d508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x7128bff7f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x7128bf6df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #28: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #30: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #31: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #33: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #34: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #36: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #37: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #38: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #39: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #40: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #42: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #43: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #45: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #47: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #49: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #52: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #53: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #54: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #55: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #56: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #57: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #58: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #59: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #60: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #61: <unknown function> + 0x29d90 (0x7128c8a29d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #62: __libc_start_main + 0x80 (0x7128c8a29e40 in /lib/x86_64-linux-gnu/libc.so.6)

W0805 22:54:32.368199 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-3.681858026951857.hpcaas_1718731_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
[W805 22:54:32.115165097 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[a100-st2-p4de24xlarge-3.681858026951857.hpcaas]:58194, remote=[ip-10-200-106-176.ec2.internal]:12341): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:653 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x98 (0x7128c79785e8 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5ba8bfe (0x7128b10d6bfe in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x5baa458 (0x7128b10d8458 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x5babc3e (0x7128b10d9c3e in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::doWait(c10::ArrayRef<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x1a6 (0x7128b10d3bc6 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::TCPStore::doGet(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x33 (0x7128b10d3fa3 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::TCPStore::get(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0xab (0x7128b10d508b in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #7: <unknown function> + 0xc28660 (0x7128bff7f660 in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x3884de (0x7128bf6df4de in /home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #9: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x507107]
frame #10: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #11: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x505093]
frame #12: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #13: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #14: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #15: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #16: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #17: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #18: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #19: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #20: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #21: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #22: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #23: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #24: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #25: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #26: _PyEval_EvalFrameDefault + 0x68a (0x4e7cba in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #27: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #28: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #29: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #30: _PyObject_FastCallDictTstate + 0x13e (0x4efc2e in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #31: _PyObject_Call_Prepend + 0xe0 (0x502b50 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #32: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5caf93]
frame #33: PyObject_Call + 0x158 (0x5055f8 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #34: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #35: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #36: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #37: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4f7e03]
frame #38: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #39: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #40: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #41: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #42: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x4e672a]
frame #43: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #44: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #45: PyEval_EvalCode + 0x1b (0x59363b in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #46: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5c0ee7]
frame #47: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5bcef0]
frame #48: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x456252]
frame #49: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #50: Py_RunMain + 0x37e (0x5b40ee in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #51: Py_BytesMain + 0x39 (0x5876f9 in /home/jianpengcheng/miniconda3/envs/def/bin/python3.9)
frame #52: <unknown function> + 0x29d90 (0x7128c8a29d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #53: __libc_start_main + 0x80 (0x7128c8a29e40 in /lib/x86_64-linux-gnu/libc.so.6)
frame #54: /home/jianpengcheng/miniconda3/envs/def/bin/python3.9() [0x5875ae]

W0805 22:54:32.394207 1718731 /opt/hpcaas/.mounts/fs-074514506a8464fcb/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1292] The node 'a100-st2-p4de24xlarge-3.681858026951857.hpcaas_1718731_0' has failed to shutdown the rendezvous '13173' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
torch.distributed.DistNetworkError: failed to recv, got 0 bytes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jianpengcheng/miniconda3/envs/def/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in main
    run(args)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/run.py", line 883, in run
    elastic_launch(
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 139, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 138, in wrapper
    result = f(*args, **kwargs)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    result = self._invoke_run(role)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 906, in _invoke_run
    num_nodes_waiting = rdzv_handler.num_nodes_waiting()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1263, in num_nodes_waiting
    self._state_holder.sync()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 437, in sync
    get_response = self._backend.get_state()
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 75, in get_state
    base64_state: bytes = self._call_store("get", self._key)
  File "/home/jianpengcheng/miniconda3/envs/def/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 119, in _call_store
    raise RendezvousConnectionError(
torch.distributed.elastic.rendezvous.api.RendezvousConnectionError: The connection to the C10d store has failed. See inner exception for details.
srun: error: a100-st2-p4de24xlarge-3: task 3: Exited with exit code 1
srun: Force Terminated StepId=472397.0
Training completed on master node. Submitting eval job...
Submitted batch job 472448
